From history

size = .5)),
size = .5)),
diag = list(continuous = wrap("densityDiag",
alpha = 0.2,
size = 0.1)),
title = "Scatterplot matrix of Social Capital Factors") +
scale_fill_manual(values=c('royalblue3','red4')) +
scale_colour_manual(values=c('royalblue3','red4'))
library(pwr)
pwr.p.test(0.316, 228, 0.05, "greater")
pwr.p.test(h=0.316, n=228, sig.level = 0.05, alternative = "greater")
pwr.p.test(h=0.565, n=378, sig.level = 0.05, alternative = "greater")
pwr.p.test(h=0.81, n=400, sig.level = 0.05, alternative = "greater")
# Data analysis for social capital and anxiety & depression among transgenders
### For Spearman correlation
bssi.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx",
sheet = "Sheet1")
library(GGally)
ggpairs(bssi.cor,
axisLabels = "none",
columns=c("BSSIScore2", "SCFacA",	"SCFacB",	"SCFacC",	"SCFacD",
"SCFacE", "SCFacF",	"SCFacG",	"SCFacH"),
columnLabels = c("BSSI", "Participation", "Agency", "Trust",
"Connection", "F&F", "Tolerance","Value of life",
"Work"),
upper = list(continuous = wrap(ggally_cor,
method = "spearman",
size = 4, colour = "red")),
lower = list(continuous = wrap("smooth",
color = "blue",
se=TRUE,
alpha = 0.3,
size = 0.2)),
diag = list(continuous = wrap("densityDiag",
alpha = 0.1)),
title = "Scatterplot matrix of Beck Suicidal Ideation Score with
Factors of Social Capital")
ggpairs(bssi.cor,
axisLabels = "none",
columns=c("BSSIScore2", "SCFacA",	"SCFacB",	"SCFacC",	"SCFacD",
"SCFacE", "SCFacF",	"SCFacG",	"SCFacH"),
columnLabels = c("BSSI", "Participation", "Agency", "Trust",
"Connection", "F&F", "Tolerance","Value of life",
"Work"),
upper = list(continuous = wrap(ggally_cor,
method = "spearman",
size = 4, colour = "red")),
lower = list(continuous = wrap("smooth",
color = "blue",
se=TRUE,
alpha = 0.3,
size = 0.2)),
diag = list(continuous = wrap("densityDiag",
alpha = 0.1)),
title = "Scatterplot matrix of Beck Suicidal Ideation Score with
Factors of Social Capital")
ggpairs(bssi.cor,
axisLabels = "none",
columns=c("BSSIScore2", "SCFacA",	"SCFacB",	"SCFacC",	"SCFacD",
"SCFacE", "SCFacF",	"SCFacG",	"SCFacH"),
columnLabels = c("BSSI", "Participation", "Agency", "Trust",
"Connection", "F&F", "Tolerance","Value of life",
"Work"),
upper = list(continuous = wrap(ggally_cor,
method = "spearman",
size = 4, colour = "red")),
lower = list(continuous = wrap("smooth",
color = "blue",
se=TRUE,
alpha = 0.3,
size = 0.2)),
diag = list(continuous = wrap("densityDiag",
alpha = 0.1)),
title = "Scatterplot matrix of Beck Suicidal Ideation Score with Factors of Social Capital")


From file in the folder:
# Data analysis for social capital and anxiety & depression among transgenders
### For Spearman correlation
bssi.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                              sheet = "Sheet1")
library(GGally)

ggpairs(bssi.cor,
        axisLabels = "none",
        columns=c("BSSIScore2", "SCFacA",	"SCFacB",	"SCFacC",	"SCFacD",
                  "SCFacE", "SCFacF",	"SCFacG",	"SCFacH"),
        columnLabels = c("BSSI", "Participation", "Agency", "Trust", 
                         "Connection", "F&F", "Tolerance","Value of life", 
                         "Work"),
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 4, colour = "red")),
        lower = list(continuous = wrap("smooth",
                                       color = "blue",
                                       se=TRUE,
                                       alpha = 0.3,
                                       size = 0.2)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.1)),
        title = "Scatterplot matrix of Beck Suicidal Ideation Score with Factors of Social Capital") 

### correlation matrix for BSSI, AKUADS & Social Capital

akuads.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                                sheet = "Sheet2")
library(GGally)

ggpairs(akuads.cor,
        axisLabels = "none",
        columns=c("AKUADSScore2",	"SCFacA",	"SCFacB", "SCFacC", "SCFacD", 
                  "SCFacE", "SCFacF",	"SCFacG",	"SCFacH"),
        columnLabels = c("AKU-ADS", "Participation", "Agency", "Trust", 
                         "Connection", "F&F", "Tolerance","Value of life", 
                         "Work"),
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 4, colour = "red")),
        lower = list(continuous = wrap("smooth",
                                       color = "blue",
                                       se=TRUE,
                                       alpha = 0.3,
                                       size = 0.4)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.2)),
        title = "Scatterplot matrix of AKU-ADS with Factors of Social Capital")

### correlation matrix for BSSI, AKUADS & Social Capital

data.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                              sheet = "Sheet4")
library(GGally)

ggpairs(data.cor,
        axisLabels = "none",
        aes(color = AKUADSCat2, alpha = 0.5),
        columns=c("AKUADSScore2","BSSIScore2", "SCTotalScore"),
        columnLabels = c("AKU-ADS","BSSI", "Social Capital"),
        legend = 1,  
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 6, colour = "black")),
        lower = list(continuous = wrap("smooth",
                                       color = "black",
                                       se=TRUE,
                                       alpha = 0.3,
                                       size = 3)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.4,
                                      size = 0.8)),
        title = "Scatterplot Matrix Between Scores of AKU-ADS, BSSI & Social Capital") +
  scale_fill_manual(values=c('midnightblue','seagreen4')) +
  scale_colour_manual(values=c('midnightblue','seagreen4')) +
  theme(legend.title = element_blank(),
        legend.position = "bottom")

### correlation matrix for BSSI, AKUADS & Social Capital

data.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                              sheet = "Sheet4")
library(GGally)

ggpairs(data.cor,
        axisLabels = "none",
        #aes(color = AKUADSCat, alpha = 0.5),
        columns=c("SCTotalScore", "BSSIScore2",	"AKUADSScore2"),
        columnLabels = c("Social Capital", "BSSI",	"AKU-ADS"),
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 6, colour = "red4")),
        lower = list(continuous = wrap("smooth",
                                       color = "royalblue3",
                                       se=TRUE,
                                       alpha = 0.2,
                                       size = 3.5)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.4,
                                      size = 1.4)),
        title = "Scatterplot Matrix Between Scores of AKU-ADS, BSSI & Social Capital")

### correlation matrix of Social Capital

sc.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                            sheet = "Sheet3")
library(GGally)

ggpairs(sc.cor,
        axisLabels = "none",
        columns=c("SCFacA",	"SCFacB",	"SCFacC",	"SCFacD",	"SCFacE",	"SCFacF",
                  "SCFacG",	"SCFacH",	"SCTotalScore"),
        columnLabels = c("Participation",	"Agency",
                         "Trust",	"Neighborhood",	"F&F", "Tolerance",
                         "Value of life",	"Work", 
                         "SC Total"),
        aes(color = AKUADSCat2, alpha = 0.5),
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 3)),
        lower = list(continuous = wrap("smooth",
                                       se=TRUE,
                                       alpha = 0.3,
                                       size = .5)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.2,
                                      size = 0.1)),
        title = "Scatterplot matrix of Social Capital Factors") +
  scale_fill_manual(values=c('royalblue3','red4')) +
  scale_colour_manual(values=c('royalblue3','red4'))


library(pwr)
### Post-hoc power analysis using obersved correlation between BSSI score
### and Social Capital Score
pwr.r.test(n = 230,
           r = -0.414, 
           sig.level = 0.05)

### Post-hoc power analysis using observed prevalence of 34.3%
pwr.p.test(h = 0.343, 
           n=230, 
           sig.level = 0.05, 
           alternative = "greater")
### Post-hoc power analysis using mean difference in SC across AKU-ADS +/- sub-sample
pwr.t2n.test(d = 15.9,
             n1 = 151, 
             n2 = 79, 
             alternative = "two.sided")
# Data analysis for social capital and anxiety & depression among transgenders
### For Spearman correlation
bssi.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                              sheet = "Sheet1")
library(GGally)

ggpairs(bssi.cor,
        axisLabels = "none",
        columns=c("BSSIScore2", "SCFacA",	"SCFacB",	"SCFacC",	"SCFacD",
                  "SCFacE", "SCFacF",	"SCFacG",	"SCFacH"),
        columnLabels = c("BSSI", "Participation", "Agency", "Trust", 
                         "Connection", "F&F", "Tolerance","Value of life", 
                         "Work"),
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 4, colour = "red")),
        lower = list(continuous = wrap("smooth",
                                       color = "blue",
                                       se=TRUE,
                                       alpha = 0.3,
                                       size = 0.2)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.1)),
        title = "Scatterplot matrix of Beck Suicidal Ideation Score with Factors of Social Capital") 

### correlation matrix for BSSI, AKUADS & Social Capital

akuads.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                                sheet = "Sheet2")
library(GGally)

ggpairs(akuads.cor,
        axisLabels = "none",
        columns=c("AKUADSScore2",	"SCFacA",	"SCFacB", "SCFacC", "SCFacD", 
                  "SCFacE", "SCFacF",	"SCFacG",	"SCFacH"),
        columnLabels = c("AKU-ADS", "Participation", "Agency", "Trust", 
                         "Connection", "F&F", "Tolerance","Value of life", 
                         "Work"),
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 4, colour = "red")),
        lower = list(continuous = wrap("smooth",
                                       color = "blue",
                                       se=TRUE,
                                       alpha = 0.3,
                                       size = 0.4)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.2)),
        title = "Scatterplot matrix of AKU-ADS with Factors of Social Capital")

### correlation matrix for BSSI, AKUADS & Social Capital

data.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                              sheet = "Sheet4")
library(GGally)

ggpairs(data.cor,
        axisLabels = "none",
        aes(color = AKUADSCat2, alpha = 0.5),
        columns=c("AKUADSScore2","BSSIScore2", "SCTotalScore"),
        columnLabels = c("AKU-ADS","BSSI", "Social Capital"),
        legend = 1,  
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 6, colour = "black")),
        lower = list(continuous = wrap("smooth",
                                       color = "black",
                                       se=TRUE,
                                       alpha = 0.3,
                                       size = 3)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.4,
                                      size = 0.8)),
        title = "Scatterplot Matrix Between Scores of AKU-ADS, BSSI & Social Capital") +
  scale_fill_manual(values=c('midnightblue','seagreen4')) +
  scale_colour_manual(values=c('midnightblue','seagreen4')) +
  theme(legend.title = element_blank(),
        legend.position = "bottom")

### correlation matrix for BSSI, AKUADS & Social Capital

data.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                              sheet = "Sheet4")
library(GGally)

ggpairs(data.cor,
        axisLabels = "none",
        #aes(color = AKUADSCat, alpha = 0.5),
        columns=c("SCTotalScore", "BSSIScore2",	"AKUADSScore2"),
        columnLabels = c("Social Capital", "BSSI",	"AKU-ADS"),
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 6, colour = "red4")),
        lower = list(continuous = wrap("smooth",
                                       color = "royalblue3",
                                       se=TRUE,
                                       alpha = 0.2,
                                       size = 3.5)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.4,
                                      size = 1.4)),
        title = "Scatterplot Matrix Between Scores of AKU-ADS, BSSI & Social Capital")

### correlation matrix of Social Capital

sc.cor <- readxl::read_xlsx("F:/Megasync/transgenderdata/Data_transgenderBSSImodification_dataUpdated.xlsx", 
                            sheet = "Sheet3")
library(GGally)

ggpairs(sc.cor,
        axisLabels = "none",
        columns=c("SCFacA",	"SCFacB",	"SCFacC",	"SCFacD",	"SCFacE",	"SCFacF",
                  "SCFacG",	"SCFacH",	"SCTotalScore"),
        columnLabels = c("Participation",	"Agency",
                         "Trust",	"Neighborhood",	"F&F", "Tolerance",
                         "Value of life",	"Work", 
                         "SC Total"),
        aes(color = AKUADSCat2, alpha = 0.5),
        upper = list(continuous = wrap(ggally_cor, 
                                       method = "spearman", 
                                       size = 3)),
        lower = list(continuous = wrap("smooth",
                                       se=TRUE,
                                       alpha = 0.3,
                                       size = .5)),
        diag = list(continuous = wrap("densityDiag", 
                                      alpha = 0.2,
                                      size = 0.1)),
        title = "Scatterplot matrix of Social Capital Factors") +
  scale_fill_manual(values=c('royalblue3','red4')) +
  scale_colour_manual(values=c('royalblue3','red4'))


library(pwr)
### Post-hoc power analysis using observed prevalence of 34.3%
pwr.p.test(h = 0.343, 
           n=230, 
           sig.level = 0.05, 
           alternative = "greater")
### Post-hoc power analysis using mean difference in SC across AKU-ADS +/- sub-sample
pwr.t2n.test(d = 15.9,
             n1 = 151, 
             n2 = 79, 
             alternative = "two.sided")






	